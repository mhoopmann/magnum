<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Magnum Configuration</title>
    <meta name="description" content="Magnum is a database search algorithm for analyzing MS/MS spectra to detect adducts of unknown mass. Where possible, search space can be sequestered to specific residues for adduct binding, and localization reported to the user.">

    <!-- Bootstrap core CSS -->
	<link href="../css/bootstrap.min.css" rel="stylesheet">
	
	<!-- Fonts -->
	<link rel="preconnect" href="https://fonts.gstatic.com">
	<link href="https://fonts.googleapis.com/css?family=Cutive+Mono|Lato" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Racing+Sans+One&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../css/magnum.css" rel="stylesheet">
	<link href="../css/pygments.css" rel="stylesheet">
	
	<!--
	<link href="../css/font-awesome.min.css" rel="stylesheet">
	-->
	
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
			
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PRGXK030V8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PRGXK030V8');
</script>
	
  </head>

  <body>

   <header>
    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-nav">
     <a class="navbar-brand" href="../index.html"><img src="../images/stache.png"></a>
     <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
     </button>
	  
	 <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav mr-auto">
	   <li class="nav-item "><a class="nav-link" href="../news/index.html">News</a></li>
	   <li class="nav-item dropdown active">
        <a class="nav-link dropdown-toggle" href="./index.html" data-toggle="dropdown" role="button" aria-expanded="false">Documentation <span class="caret"></span></a>
        <div class="dropdown-menu" role="menu">
         <a class="dropdown-item active" href="./index.html">Instructions</a>
         <a class="dropdown-item " href="../param/index.html">Parameters</a>
         <a class="dropdown-item " href="../notes.html">Release Notes</a>
	     <div class="dropdown-divider"></div>
	     <a class="dropdown-item " href="../cite.html">Citing, Publications & Tools</a>
        </div>
	   </li>
       <li class="nav-item "><a class="nav-link" href="../download.html">Download</a></li>
	   <li class="nav-item "><a class="nav-link" href="../source.html">Source</a></li>
	   <li class="nav-item"><a href="https://isbscience.org/" target="_blank"><img src="../images/ISB-Symbol.png" width="40"></a></li>
      </ul>
     </div>
	 
    </nav>
   </header>
  
<main role="main">

<div class="container padded">
 <div class="row">
  <div class="col-md-9">
   <h2 id="configuring-magnum">Configuring Magnum</h2>

<p>Due to the large number of parameters used in any Magnum analysis, all parameters are set in a configuration file
rather than typed out on the command line. A sample configuration file is provided with Magnum, and can also be
copied from <a href="../docs/sample.html">this example</a>.</p>

<p>Changing parameters should be done from any ASCII text editor, such as <code class="highlighter-rouge">vim</code> in Linux, or <code class="highlighter-rouge">notepad</code> in Windows.
For ease of reading, parameter names use english words instead of single letters. Notes are defined as any
text that appears after the <code class="highlighter-rouge">#</code> symbol on each line. Notes are not processed as parameters and are there to
provide helpful information to users. Feel free to add additional notes as needed for your analysis.</p>

<div class="alert alert-info">
<h4>Helpful Hint</h4>
<p class="hint">Make a different configuration file for each analysis you wish to perform. Simply copy an existing configuration
file, then give it a unique name and adjust the parameters. Thus, you preserve the unique parameter settings
for each of your analyses.</p>
</div>

<p>For clarity, the parameters have been divided into six groups by similarity. This page will describe the most
important parameters within those groups. A complete list of all parameters and their descriptions can be found
on the <a href="../param/index.html">Parameters</a> page.</p>

<hr />

<h4 id="1-data-io">1. Data I/O</h4>

<p>The Data I/O parameters describe files that will be imported and exported from Magnum during analysis. There are two key
files for input: your MS data file and a protein sequence database:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>database = polymerase_proteins.fasta
MS_data_file = my_data.mzML
</code></pre></div></div>

<p>There are two points worth mentioning in the above example. First, the protein sequence database is an ASCII text
file of the <code class="highlighter-rouge">FASTA</code> format. It should contain both target proteins (sequences you hope to find) and decoy proteins
(sequences you know are false). Second, the mass spectrometry data file must be in an approved format. On all systems,
those formats are <code class="highlighter-rouge">mzML</code> (recommended) and <code class="highlighter-rouge">mzXML</code>. Additionally, <code class="highlighter-rouge">Thermo RAW</code> files may be used on Windows systems
if the appropriate <a href="http://sjsupport.thermofinnigan.com/public/detail.asp?id=703" target="new">drivers</a> have 
been installed.</p>

<div class="alert alert-info">
<h4>Helpful Hint</h4>
<p class="hint">FASTA sequence database files should contain both target and decoy sequences if you wish to use
Percolator for results validation. Below is an example of what a target protein sequence and its matching decoy
sequence might look like:</p>
<pre>&gt;Protein_1
MTHISISMYPRTEINSEKWENCE
&gt;Decoy_1_reverse
ECNEWKESNIETRPYMSISIHTM</pre>	
</div>

<div class="alert alert-info">
<h4>Helpful Hint</h4>
<p class="hint">Magnum looks for files in the current working directory, i.e. the directory you are in. You can provide relative
paths to parent- and sub-directories if desired. To ensure input and output is directed from and to a specific location
no matter which directory you are in, provide an absolute path with your files:</p>
<pre>database = C:\databases\e_coli.fasta</pre>	
</div>

<p>The remaining parameters in this group define exported content after Magnum analysis is complete. All output is in tab-delimited
ASCII text files. The standard output file contains a complete summary of the results in a single file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>output_file = my_results.txt
</code></pre></div></div>

<p>The Percolator parameters return the same results, but formatted such that they can be directly imported to Percolator for
validation of the peptide spectrum matches (PSMs):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>percolator_file = my_results_perc_format
percolator_version = 2.07
</code></pre></div></div>

<p>For the <code class="highlighter-rouge">percolator_file</code> parameter, no extension is necessary. The <code class="highlighter-rouge">percolator_version</code> number should match the version of Percolator you will be using, as input
formats differ between Percolator versions. Magnum will automatically format the results to match the version you specify.</p>

<hr />

<h4 id="2-data-descriptors">2. Data Descriptors</h4>

<p>The Data Descriptor parameters describe the spectra to be analyzed. Accurate description of the spectra ensures the
correct spectrum processing is performed during the Magnum analysis.</p>

<p>During Magnum analysis, all profile MS peaks must be converted to centroid MS peaks. Magnum has built-in functionality to
perform this operation, but requires additional information about the instrument used and the resolution settings.
Correctly setting these values will produce the most accurate centroid peak conversion. First, identify whether or not
the spectra are centroided at the MS and MS/MS levels:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MS1_centroid = 0
MS2_centroid = 1
</code></pre></div></div>

<p>In the above example, 0 indicates profile peaks and 1 indicates centroid peaks. The parameters thus tell Magnum
that the MS spectra are profile, and the MS/MS spectra are centroid. As a result, only the MS peaks will be converted
to centroid values during the analysis. However, Magnum will need additional information about the peaks, such as
what instrument they were acquired on, and at what resolution:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>instrument = 0
MS1_resolution = 55000
</code></pre></div></div>

<p>Here, the 0 for <code class="highlighter-rouge">instrument</code> indicates an orbitrap mass analyzer. The resolution is approximated at 400 m/z, which
may differ from m/z value the manufacturer reports. Make sure you report the resolution at 400 m/z. <code class="highlighter-rouge">MS2_resolution</code>
is not used in this example, because we set <code class="highlighter-rouge">MS2_centroid = 1</code>, and thus any value for that parameter is ignored
during analysis.</p>

<div class="alert alert-info">
<h4>Helpful Hint</h4>
<p class="hint">Don't want to worry about setting the correct parameters to convert profile peaks to centroid? Simply give
Magnum a data file where all the peaks are already centroided. With the right tool, such as <i>msconvert</i> from
<a href="http://proteowizard.sourceforge.net/" class="alert-link" target="new">ProteoWizard</a>, you can do this 
when converting your raw data to an mzML file.</p>
</div>

<p>The <code class="highlighter-rouge">enrichment</code> parameter is always set to 0, unless you performed peptide c-terminus labeling during the enzymatic
digestion step of your sample prep. Details of how and when to use this parameter are found on the 
<a href="../param/index.html">Parameters</a> page.</p>

<hr />

<h4 id="3-open-modifications-and-adducts">3. Open Modifications and Adducts</h4>

<p>The characteristic features of Magnum are the ability to detect unspecified modification masses on peptides analyzed by
mass spectrometry, and possibly localize them on the peptide backbone. When combined with some <em>a priori</em> knowledge, these
features become powerful tools for detecting novel chemical moieties and adducts resulting from treatments to your protein samples.</p>

<p>If your adduct masses are known, they are best identified through standard modification analyses. However, if the precise adduct mass
is unknown, a range of potential adduct masses are specified with two simple parameters:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>min_adduct_mass = 50.0
max_adduct_mass = 300.0
</code></pre></div></div>

<p>In the example above, any open modification mass between 50 and 300 Da will be searched on all peptide sequences. If a peptide
with an open modification in this range scores higher than any other peptide sequence (including those without modifications or
more typical variable modifications), then this open-modified PSM will be reported in the Magnum results.</p>

<p>A unique feature to Magnum is the ability to localize the open modifcation or adduct to a particular peptide residue or set
of residues, including the protein termini. Localization has several advantages, foremost in restricting the open search space
to a realistic subset of peptides. This feature is especially useful if your adduct has reactive sites that limit its interactions
to particular chemical moieties. Localization may also help in downstream curation of the results. To set localization, use the
following parameter:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>adduct_sites = nK
</code></pre></div></div>

<p>The example above limits the open modification search space to primary amines (lysines and the protein n-terminus). To have a complete
open modification search, it is possible to specify all amino acids. Localization will still occur if there is fragmentation evidence
to place the adduct on a particular residue.</p>

<p>One final note on addut localization. Explicit localization to a specific residue is only made if there is fragmentation ion evidence for
the localization. If there is no fragmentation evidence (i.e. the adduct mass simply makes it possible to observe the fragment ions without the
adduct - common among labile adducts), then the adduct mass is still reported to the user, but without an localization indicators, even if
there is only a single possible site for the adduct to bind.</p>

<hr />

<h4 id="4-modifications">4. Modifications</h4>

<p>The Modifications parameters refer to amino acid modifications that are independent of the open modification/adduct searches.
These occur naturally (e.g. post-translational modifications) or as a result of sample preparation 
(e.g. carbamidomethylcysteine):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fixed_modification = C 57.02146
modification = M 15.9949
max_mods_per_peptide = 2
</code></pre></div></div>

<p>The <code class="highlighter-rouge">fixed_modification</code> and <code class="highlighter-rouge">modification</code> parameters each require two values: a target and a mass. The
<code class="highlighter-rouge">fixed_modification</code> parameter specifies a static mass that is added to the normal mass of the indicated peptide. The
<code class="highlighter-rouge">modification</code> parameter specifies a mass that may or may not be on the peptide. Because each <code class="highlighter-rouge">modification</code> exponentially
increases search time, you can limit the number of differential <code class="highlighter-rouge">modifications</code> to a practical number. You can also
specify multiple <code class="highlighter-rouge">fixed_modification</code> and <code class="highlighter-rouge">modification</code> parameter lines to indication multiple different mass modifications
you expect to find in your analysis.</p>

<div class="alert alert-info">
<h4>Helpful Hint</h4>
<p class="hint">You can specify multiple differential modifications for the same amino acid. Place each modification on a separate
line, but indicate the same amino acid with a different mass.</p>
</div>

<hr />

<h4 id="5-scoring-algorithm">5. Scoring Algorithm</h4>

<p>The Scoring Algorithm parameters describe the tolerances applied to the scoring algorithm for analyzing MS/MS spectra
of different resolutions and mass accuracy. High-resolution MS/MS have a really small mass tolerance and no mass offset.
Below is an example of values appropriate for high-resolution (e.g. orbitrap) MS/MS spectra:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fragment_bin_size = 0.03
fragment_bin_offset = 0.0
</code></pre></div></div>

<p>Low-resolution (e.g. ion trap) MS/MS spectra need a much wider mass tolerance, and an offset to make sure the peak values
are most likely to fall within the center of the mass tolerance. For low-resolution MS/MS spectra, the following
parameter values are recommended:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fragment_bin_size = 1.0005
fragment_bin_offset = 0.4
</code></pre></div></div>

<hr />

<h4 id="6-analysis">6. Analysis</h4>

<p>The Analysis parameters are the largest set of parameters, but are easy to understand and use. Not all parameters are
listed in these examples. You can find the complete list on the <a href="../param/index.html">Parameters</a> page.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>enzyme = [KR]|{P}
max_miscleavages = 2
</code></pre></div></div>

<p>The above two parameters indicate the trypsin enzyme cleavage rule and the number of missed cleavages allowed.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>min_peptide_mass = 500.0
max_peptide_mass = 6000.0
min_peptide_length = 7
max_peptide_length = 40
</code></pre></div></div>

<p>The peptide mass boundaries shown above are important to understand, but once set, you probably will use the same values
for all Magnum analyses. These parameters determine the smallest and largest peptides to be searched, by mass in Daltons,
not by number of amino acids. Additionally, residue counts are used to limit peptides to those of reasonable lengths regardless
of mass. For example with the settings above, if a peptide has mass greater than 500 Da, but is only six residues in length,
it will not be searched.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ppm_tolerance_pre = 25.0
prefer_precursor_pred = 1
</code></pre></div></div>

<p>These two parameters help define the search space for each spectrum. <code class="highlighter-rouge">ppm_tolerance_pre</code> defines the tolerance around
the precursor mass, in parts per million, that a PSM is allowed to have to be accepted. Setting a value similar to your
instrument mass accuracy is recommended, but there are various reasons to use much larger or smaller values that are
outside the scope of this manual. Sometimes, such as with <code class="highlighter-rouge">Thermo RAW</code> data, a suggested monoisotopic precursor mass
is provided for a spectrum. It is often helpful to use this value, which is indicated by setting <code class="highlighter-rouge">prefer_precursor_pred</code>
to 1. If you set the value to 0, then Magnum will compute new monoisotopic precursor masses for the spectra. Regardless
of this parameter setting, if no precursor monoisotopic masses were previously assigned to the spectra, Magnum will compute
them.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spectrum_processing = 1
max_spectrum_peaks = 0
</code></pre></div></div>

<p>The two parameters above determine if and how MS/MS spectra are processed. <code class="highlighter-rouge">spectrum_processing</code> can be turned off by
setting the value to 0. As <code class="highlighter-rouge">spectrum_processing</code> is only intended for high-resolution MS/MS, it should be turned off
for low-resolution MS/MS data. Processing the spectra involves collapsing isotope distributions to the monoisotopic
peak to facilitate better scoring algorithm performance. Additionally, you can remove presumed noise peaks by limiting
the number of peaks to analyze after collapsing using the <code class="highlighter-rouge">max_spectrum_peaks</code> parameter. For example, setting this
parameter to 200 will limit the analysis to only the tallest 200 peaks in the spectrum. Setting the value to 0 will
cause analysis using all peaks in the spectrum.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>decoy_filter = DECOY
</code></pre></div></div>

<p>This last parameter is critical for downstream validation using Percolator. It defines a case-sensitive word that is
found only in the labels of your decoy database sequences. The decoy word can be any that you prefer, but make sure
it does not appear in the labels of your target sequences, or they will incorrectly be assigned as decoys.</p>

   </div>
   <div class="col-md-3">
    <nav class="nav flex-column sidebar-module sidebar-module-inset">
     <h5 class="sidebar-header">Basics</h5>
	 
	 <a class="nav-link sidebar-link" href="../docs/index.html">Overview</a>
	 
	 <a class="nav-link sidebar-link" href="../docs/quick.html">Quick Start Guide</a>
	 
	 <a class="nav-link sidebar-link" href="../docs/magnumresults.html">Magnum Results</a>
	 
	 <h5 class="sidebar-header">Explore in Detail</h5>
     
     <a class="nav-link sidebar-link" href="../docs/installation.html">Installation</a>
     
     <a class="nav-link sidebar-link" href="../docs/config.html">Configuration</a>
     
     <a class="nav-link sidebar-link" href="../docs/running.html">Running Magnum</a>
     
     <a class="nav-link sidebar-link" href="../docs/validation.html">Validating PSMs</a>
     
	 <h5 class="sidebar-header">Tutorials</h5>
     
     <a class="nav-link sidebar-link" href="../docs/percresults.html">Using Percolator</a>
     
     <a class="nav-link sidebar-link" href="../docs/docker.html">Magnum Protein Adduct Pipeline</a>
     
    </nav>
   </div>
  </div>
 </div>
</div>

    
 </main>

	<footer class="footer fixed-bottom">
	 <div class="container">
      <p class="float-right"><a class="text-accent" href="#">Back to top</a></p>
      <p>&copy; 2021 <a class="text-accent" target="new" href="https://isbscience.org">ISB</a></p>
	 </div>
    </footer>
	
	<!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="../js/bootstrap.min.js"></script>

  </body>
</html>
